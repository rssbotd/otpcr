#!/usr/bin/env python3
# This file is placed in the Public Domain.
# pylint: disable=C0413,W0611


"prompt"


import getpass
import os
import readline
import sys
import termios


from otpcr.error  import errors
from otpcr.object import Default, construct, fmt
from otpcr.main   import Broker, Client, Commands, Config, Event
from otpcr.main   import command, forever, modnames, parse, wrap
from otpcr.mods   import face


Cfg = Config()
Cfg.mod = ",".join(modnames(face))


class CLI(Client):

    "CLI"

    def raw(self, txt):
        print(txt)


def wrapped():
    "wrap main."
    wrap(main)
    errors(print)


def main():
    "main"
    parse(Cfg, " ".join(sys.argv[1:]))
    clt = CLI()
    if Cfg.txt:
        evt = Event()
        evt.orig = repr(clt)
        parse(evt, Cfg.otxt)
        command(evt)


if __name__ == "__main__":
    wrapped()
